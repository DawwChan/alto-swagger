swagger: "2.0"
info:
  version: "0.1.0"
  title: Basic Data Type of Unicorn
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: SNLab.Org
    url: https://snlab.github.io/
    email: snlab.org@gmail.com
paths: {}
definitions:
  FlowSpec:
    type: object
    required:
    - dst-ip
    properties:
      src-ip:
        type: string
        pattern: ^((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|$
      dst-ip:
        type: string
        pattern: ^((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|$
      src-port:
        type: integer
        format: int32
        minimum: 0
        maximum: 65535
      dst-port:
        type: integer
        format: int32
        minimum: 0
        maximum: 65535
      protocol:
        type: string
        enum:
        - tcp
        - udp
        - sctp
  QueryDesc:
    type: object
    required:
    - flow
    - ingress-point
    properties:
      flow:
        $ref: "#/definitions/FlowSpec"
      ingress-point:
        type: string
        pattern: ^((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|$
